<?xml version="1.0" encoding="UTF-8"?>
<TestBasedCertificationModel xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xsi:noNamespaceSchemaLocation="file:/Users/filippogaudenzi/Documents/workspace/CumulusTestManager/XML_Repository/CertificationModelv3.xsd">
    <CertificationModelId>
        <CmId>TEST000006</CmId>
    </CertificationModelId>
   
    <Collectors>        
          
                <AbstractCollector Id="abstract1">
                    <Aggregator >
                        <ModelLink>http://www.cumulus-project.eu/Model005.html</ModelLink>
                        <TestMetric>
                            <OperationCoverage>1</OperationCoverage>
                            <InputPartitionCoverage/> 
                            <BranchCoverage/>
                            <ConditionCoverage/>
                            <PathCoverage/>
                            <AttackCoverage/> 
                            <Other> </Other>
                        </TestMetric>
                        <ElementForExtension>
                            <Environment/>            
                            <TestingTool>no</TestingTool>            
                            <Code/>            
                            <Others/>           
                        </ElementForExtension>
                    </Aggregator>
                    <TestCategory>Functionality</TestCategory>
                    <TestType>Model Control Flow</TestType>
                    <TestDescription>Send user/pass (with malformed pass) to registerUser API. RegisterUser result must be "fail".</TestDescription>
                    <TestGenerationModelLink>http://www.cumulus-project.eu/model005.html</TestGenerationModelLink>
                    <TestAttributes>
                        <TestAttribute>
                            <ID>1</ID>
                            <Name>cardinality</Name>
                            <Value>1</Value>
                        </TestAttribute>
                    </TestAttributes>
                    <TestCases>                    
                    <TestCase>
                    <ID>1</ID>
                    <Description>user generation</Description>
                     <TestInstance Operation="registerUser">
                        <Preconditions/>                       
                        <HiddenCommunications/>                        
                        <Input>username=fred; password="12345"</Input>
                        <ExpectedOutput>fail</ExpectedOutput>
                        <PostConditions></PostConditions>
                     </TestInstance>                     
                     </TestCase> 
                    </TestCases>
                </AbstractCollector>


                <AbstractCollector Id="abastract2">
                    <Aggregator>
                        <ModelLink>http://www.cumulus-project.eu/Model005.html</ModelLink>
                        <TestMetric>
                            <OperationCoverage>1</OperationCoverage>
                            <InputPartitionCoverage/> 
                            <BranchCoverage/>
                            <ConditionCoverage/>
                            <PathCoverage/>
                            <AttackCoverage/> 
                            <Other> </Other>
                        </TestMetric>
                        <ElementForExtension>
                            <Environment/>            
                            <TestingTool>no</TestingTool>            
                            <Code/>            
                            <Others/>           
                        </ElementForExtension>
                    </Aggregator>
                    <TestCategory>Functionality</TestCategory>
                <TestType></TestType>
                    <TestDescription>Send user/pass (with wellformed pass) to registerUser API. Login result must be "success".</TestDescription>
                    <TestGenerationModelLink>http://www.cumulus-project.eu/model006.html</TestGenerationModelLink>
                <TestAttributes>
                    <TestAttribute>
                        <ID>1</ID>
                        <Name>cardinality</Name>
                        <Value>1</Value>
                    </TestAttribute>
                </TestAttributes>
                <TestCases>                    
                    <TestCase>
                        <ID>1</ID>
                        <Description>login</Description>
                        <TestInstance Operation="login">
                            <Preconditions>ACL with user/pass with password satisfying secret-level1-policy-correctness (n. of pairs = 1)</Preconditions>
                            <HiddenCommunications></HiddenCommunications>
                            <Input>username,password</Input>
                            <ExpectedOutput>success</ExpectedOutput>
                            <PostConditions></PostConditions>
                        </TestInstance>                     
                    </TestCase> 
                </TestCases>
            </AbstractCollector>
               
                <AbstractCollector Id="abstract3">
                    <Aggregator>
                        <ModelLink>http://www.cumulus-project.eu/Model005.html</ModelLink>
                        <TestMetric>
                            <OperationCoverage>1</OperationCoverage>
                            <InputPartitionCoverage/> 
                            <BranchCoverage/>
                            <ConditionCoverage/>
                            <PathCoverage/>
                            <AttackCoverage/> 
                            <Other> </Other>
                        </TestMetric>
                        <ElementForExtension>
                            <Environment/>            
                            <TestingTool>no</TestingTool>            
                            <Code/>            
                            <Others/>           
                        </ElementForExtension>
                    </Aggregator>
                    <TestCategory>Functionality</TestCategory>
                <TestType></TestType>
                <TestDescription>Send user/pass (with wellformed pass) to login API for 100 times. Logins must fails. 100th login  must lockout user.</TestDescription>
                <TestGenerationModelLink>http://www.cumulus-project.eu/model007.html</TestGenerationModelLink>
                <TestAttributes>
                    <TestAttribute>
                        <ID>1</ID>
                        <Name>cardinality</Name>
                        <Value>100</Value>
                    </TestAttribute>
                </TestAttributes>
                <TestCases>                    
                    <TestCase>
                        <ID>1</ID>
                        <Description></Description>
                        <TestInstance Operation="login">
                            <Preconditions>sleepTime="00:07:00.000"</Preconditions>
                            <HiddenCommunications/>
                            <Input>username,password</Input>
                            <ExpectedOutput>fail</ExpectedOutput>
                            <PostConditions></PostConditions>
                        </TestInstance>                     
                    </TestCase> 
                    <TestCase>
                        <ID>2</ID>
                        <Description></Description>
                        <TestInstance Operation="login">
                            <Preconditions>sleepTime="00:07:00.000"</Preconditions>
                            <HiddenCommunications/>
                            <Input>username,password</Input>
                            <ExpectedOutput>fail</ExpectedOutput>
                            <PostConditions></PostConditions>
                        </TestInstance>                     
                    </TestCase> 
                    <TestCase>
                        <ID>3</ID>
                        <Description></Description>
                        <TestInstance Operation="login">
                            <Preconditions>sleepTime="00:07:00.000"</Preconditions>
                            <HiddenCommunications/>
                            <Input>username,password</Input>
                            <ExpectedOutput>fail</ExpectedOutput>
                            <PostConditions></PostConditions>
                        </TestInstance>                     
                    </TestCase> 
                    <TestCase>
                        <ID>4</ID>
                        <Description></Description>
                        <TestInstance Operation="login">
                            <Preconditions>sleepTime="00:07:00.000"</Preconditions>
                            <HiddenCommunications/>
                            <Input>username,password</Input>
                            <ExpectedOutput>fail</ExpectedOutput>
                            <PostConditions></PostConditions>
                        </TestInstance>                     
                    </TestCase> 
                    <TestCase>
                        <ID>5</ID>
                        <Description></Description>
                        <TestInstance Operation="login">
                            <Preconditions>sleepTime="00:07:00.000"</Preconditions>
                            <HiddenCommunications/>
                            <Input>username,password</Input>
                            <ExpectedOutput>lockout</ExpectedOutput>
                            <PostConditions></PostConditions>
                        </TestInstance>                     
                    </TestCase> 
                </TestCases>
            </AbstractCollector>
                        
            <!-- tests for level 2 of user-authentication-and-identity-assurance-level -->             
               
               
                <AbstractCollector Id="abstract4">
                    <Aggregator>
                        <ModelLink>http://www.cumulus-project.eu/Model005.html</ModelLink>
                        <TestMetric>
                            <OperationCoverage>1</OperationCoverage>
                            <InputPartitionCoverage/> 
                            <BranchCoverage/>
                            <ConditionCoverage/>
                            <PathCoverage/>
                            <AttackCoverage/> 
                            <Other> </Other>
                        </TestMetric>
                        <ElementForExtension>
                            <Environment/>            
                            <TestingTool>no</TestingTool>            
                            <Code/>            
                            <Others/>           
                        </ElementForExtension>
                    </Aggregator>
                    <TestCategory>Functionality</TestCategory>
                    <Actionability>
                        <Description>mechanism</Description>
                        <Mechanism>access control</Mechanism>
                        <MechanismURI>http://www.cumulus.eu/mechanism1033.html</MechanismURI>
                    </Actionability>
                    <Capability>
                        <Attacker>CloudProvider</Attacker>
                        <AttackName></AttackName>
                        <AttackerCapabilities> 
                            <CapabilityId>1</CapabilityId>
                            <AttackerCapability>R</AttackerCapability>
                            <CapabilityId>2</CapabilityId>
                            <AttackerCapability>W</AttackerCapability>
                            <CapabilityId>3</CapabilityId>
                            <AttackerCapability>X</AttackerCapability>
                        </AttackerCapabilities>
                        <Attacker>Hacker</Attacker>
                        <AttackName></AttackName>
                        <AttackerCapabilities> 
                            <CapabilityId>1</CapabilityId>
                            <AttackerCapability>R</AttackerCapability>
                        </AttackerCapabilities>
                    </Capability>
                    <TestType></TestType>
                    <TestDescription>Send user/pass (with malformed pass) to registerUser API. RegisterUser result must be "fail".</TestDescription>
                    <TestGenerationModelLink>http://www.cumulus-project.eu/model005.html</TestGenerationModelLink>
                    <TestAttributes>
                        <TestAttribute>
                            <ID>1</ID>
                            <Name>cardinality</Name>
                            <Value>1</Value>
                        </TestAttribute>
                    </TestAttributes>
                    <TestCases>                    
                        <TestCase>
                            <ID>1</ID>
                            <Description>user generation</Description>
                            <TestInstance Operation="registerUser">
                                <Preconditions/>                       
                                <HiddenCommunications/>                        
                                <Input>username=fred; password="1234567"</Input>
                                <ExpectedOutput>fail</ExpectedOutput>
                                <PostConditions></PostConditions>
                            </TestInstance>                     
                        </TestCase> 
                    </TestCases>
                    
                </AbstractCollector>
                
        
        
                <AbstractCollector Id="abstract5">
                    <Aggregator>
                        <ModelLink>http://www.cumulus-project.eu/Model005.html</ModelLink>
                        <TestMetric>
                            <OperationCoverage>1</OperationCoverage>
                            <InputPartitionCoverage/> 
                            <BranchCoverage/>
                            <ConditionCoverage/>
                            <PathCoverage/>
                            <AttackCoverage/> 
                            <Other> </Other>
                        </TestMetric>
                        <ElementForExtension>
                            <Environment/>            
                            <TestingTool>no</TestingTool>            
                            <Code/>            
                            <Others/>           
                        </ElementForExtension>
                    </Aggregator>
                    <TestCategory>Functionality</TestCategory>
                    <TestType></TestType>
                    <TestDescription>Send user/pass (with wellformed pass) to registerUser API. Login result must be "success".</TestDescription>
                    <TestGenerationModelLink>http://www.cumulus-project.eu/model006.html</TestGenerationModelLink>
                    <TestAttributes>
                        <TestAttribute>
                            <ID>1</ID>
                            <Name>cardinality</Name>
                            <Value>1</Value>
                        </TestAttribute>
                    </TestAttributes>
                    <TestCases>                    
                        <TestCase>
                            <ID>1</ID>
                            <Description>login</Description>
                            <TestInstance Operation="login">
                                <Preconditions></Preconditions>
                                <HiddenCommunications></HiddenCommunications>
                                <Input>username,password</Input>
                                <ExpectedOutput>success</ExpectedOutput>
                                <PostConditions></PostConditions>
                            </TestInstance>                     
                        </TestCase> 
                    </TestCases>
                </AbstractCollector>
                
        
        <AbstractCollector Id="abstract6">
            <Aggregator>
                <ModelLink>http://www.cumulus-project.eu/Model005.html</ModelLink>
                <TestMetric>
                    <OperationCoverage>1</OperationCoverage>
                    <InputPartitionCoverage/> 
                    <BranchCoverage/>
                    <ConditionCoverage/>
                    <PathCoverage/>
                    <AttackCoverage/> 
                    <Other> </Other>
                </TestMetric>
                <ElementForExtension>
                    <Environment/>            
                    <TestingTool>no</TestingTool>            
                    <Code/>            
                    <Others/>           
                </ElementForExtension>
            </Aggregator>
                    <TestCategory>Functionality</TestCategory>
                    <TestType></TestType>
                    <TestDescription>Send user/pass (with wellformed pass) to login API for 100 times. Logins must fails. 100th login  must lockout user.</TestDescription>
                    <TestGenerationModelLink>http://www.cumulus-project.eu/model007.html</TestGenerationModelLink>
                    <TestAttributes>
                        <TestAttribute>
                            <ID>1</ID>
                            <Name>cardinality</Name>
                            <Value>100</Value>
                        </TestAttribute>
                    </TestAttributes>
                    <TestCases>                    
                        <TestCase>
                            <ID>1</ID>
                            <Description></Description>
                            <TestInstance Operation="login">
                                <Preconditions>sleepTime="00:07:00.000"</Preconditions>
                                <HiddenCommunications/>
                                <Input>username,password</Input>
                                <ExpectedOutput>fail</ExpectedOutput>
                                <PostConditions></PostConditions>
                            </TestInstance>                     
                        </TestCase> 
                        <TestCase>
                            <ID>2</ID>
                            <Description></Description>
                            <TestInstance Operation="login">
                                <Preconditions>sleepTime="00:07:00.000"</Preconditions>
                                <HiddenCommunications/>
                                <Input>username,password</Input>
                                <ExpectedOutput>fail</ExpectedOutput>
                                <PostConditions></PostConditions>
                            </TestInstance>                     
                        </TestCase> 
                        <TestCase>
                            <ID>3</ID>
                            <Description></Description>
                            <TestInstance Operation="login">
                                <Preconditions>sleepTime="00:07:00.000"</Preconditions>
                                <HiddenCommunications/>
                                <Input>username,password</Input>
                                <ExpectedOutput>fail</ExpectedOutput>
                                <PostConditions></PostConditions>
                            </TestInstance>                     
                        </TestCase> 
                        <TestCase>
                            <ID>4</ID>
                            <Description></Description>
                            <TestInstance Operation="login">
                                <Preconditions>sleepTime="00:07:00.000"</Preconditions>
                                <HiddenCommunications/>
                                <Input>username,password</Input>
                                <ExpectedOutput>fail</ExpectedOutput>
                                <PostConditions></PostConditions>
                            </TestInstance>                     
                        </TestCase> 
                        <TestCase>
                            <ID>101</ID>
                            <Description></Description>
                            <TestInstance Operation="login">
                                <Preconditions>sleepTime="00:07:00.000"</Preconditions>
                                <HiddenCommunications/>
                                <Input>username,password</Input>
                                <ExpectedOutput>lockout</ExpectedOutput>
                                <PostConditions></PostConditions>
                            </TestInstance>                     
                        </TestCase> 
                    </TestCases>
                </AbstractCollector>
                                     
               
        
        <Collector ExpirationTime="2014-09" toDeploy="true" isStatic="true" Id="col2">
            <ConditionForSomministration><DeltaTime>12:00:00</DeltaTime></ConditionForSomministration>
            <AbstractCollector>abstract1</AbstractCollector>
        </Collector>
       
        <Collector ExpirationTime="2014-09"  toDeploy="true" isStatic="true" Id="col1">
            <ConditionForSomministration>
                <Event>
                    <Action>Login</Action>
                    <Condition> failed
                    </Condition>
                    <Value>100</Value>
                </Event>
            </ConditionForSomministration>
            <AbstractCollector>abstract4</AbstractCollector>
        </Collector>
    </Collectors>
   



    <LifeCycle InitialState="NOT_ISSUED">
        <LifeCycleStates NumberOfStates="5">            
            <LifeCycleId>ID1</LifeCycleId>
            <LifeCycleState>NOT_ISSUED</LifeCycleState>
            <LifeCycleTransitions>
                <lifeCycleTransition>
                    <FromState>NOT_ISSUED</FromState>
                    <ToState>ISSUED</ToState>
                    <ConditionForLifeCycleTransition>
                        <EvidenceIsValid>true</EvidenceIsValid>
                    </ConditionForLifeCycleTransition>
                </lifeCycleTransition>
            </LifeCycleTransitions>            
            <LifeCycleId>ID2</LifeCycleId>
            <LifeCycleState>ISSUED</LifeCycleState>
            <LifeCycleTransitions>
                <lifeCycleTransition>
                    <FromState>ISSUED</FromState>
                    <ToState>EXPIRED</ToState>
                    <ConditionForLifeCycleTransition>
                        <ValidityPeriodExpired>true</ValidityPeriodExpired>
                    </ConditionForLifeCycleTransition>
                </lifeCycleTransition>
                <lifeCycleTransition>
                    <FromState>ISSUED</FromState>
                    <ToState>SUSPENDED</ToState>
                    <ConditionForLifeCycleTransition>
                        <EvidenceIsQuestionable>true</EvidenceIsQuestionable>
                    </ConditionForLifeCycleTransition>
                </lifeCycleTransition>
                <lifeCycleTransition>
                    <FromState>ISSUED</FromState>
                    <ToState>REVOKED</ToState>
                    <ConditionForLifeCycleTransition>
                        <EvidenceIsNotValid>true</EvidenceIsNotValid>
                    </ConditionForLifeCycleTransition>
                </lifeCycleTransition>
                <lifeCycleTransition>
                    <FromState>SUSPENDED</FromState>
                    <ToState>ISSUED</ToState>
                    <ConditionForLifeCycleTransition>
                        <EvidenceIsValid>true</EvidenceIsValid>
                    </ConditionForLifeCycleTransition>
                </lifeCycleTransition>
            </LifeCycleTransitions>
            <LifeCycleId>ID3</LifeCycleId>
            <LifeCycleState>SUSPENDED</LifeCycleState>
            <LifeCycleTransitions>
                <lifeCycleTransition>
                    <FromState>SUSPENDED</FromState>
                    <ToState>EXPIRED</ToState>
                    <ConditionForLifeCycleTransition>
                        <ValidityPeriodExpired>true</ValidityPeriodExpired>
                    </ConditionForLifeCycleTransition>
                </lifeCycleTransition>
                <lifeCycleTransition>
                    <FromState>SUSPENDED</FromState>
                    <ToState>ISSUED</ToState>
                    <ConditionForLifeCycleTransition>
                        <EvidenceIsValid>true</EvidenceIsValid>
                    </ConditionForLifeCycleTransition>
                </lifeCycleTransition>
                <lifeCycleTransition>
                    <FromState>SUSPENDED</FromState>
                    <ToState>REVOKED</ToState>
                    <ConditionForLifeCycleTransition>
                        <EvidenceIsNotValid>true</EvidenceIsNotValid>
                    </ConditionForLifeCycleTransition>
                </lifeCycleTransition>
                <lifeCycleTransition>
                    <FromState>ISSUED</FromState>
                    <ToState>SUSPENDED</ToState>
                    <ConditionForLifeCycleTransition>
                        <EvidenceIsQuestionable>true</EvidenceIsQuestionable>
                    </ConditionForLifeCycleTransition>
                </lifeCycleTransition>
            </LifeCycleTransitions>           
            <LifeCycleId>ID4</LifeCycleId>
            <LifeCycleState>EXPIRED</LifeCycleState>
            <LifeCycleTransitions>
                <lifeCycleTransition>
                    <FromState>ISSUED</FromState>
                    <ToState>EXPIRED</ToState>
                    <ConditionForLifeCycleTransition>
                        <ValidityPeriodExpired>true</ValidityPeriodExpired>
                    </ConditionForLifeCycleTransition>
                </lifeCycleTransition>
                <lifeCycleTransition>
                    <FromState>SUSPENDED</FromState>
                    <ToState>EXPIRED</ToState>
                    <ConditionForLifeCycleTransition>
                        <ValidityPeriodExpired>true</ValidityPeriodExpired>
                    </ConditionForLifeCycleTransition>
                </lifeCycleTransition>
            </LifeCycleTransitions>            
            <LifeCycleId>ID5</LifeCycleId>
            <LifeCycleState>REVOKED</LifeCycleState>
            <LifeCycleTransitions>
                <lifeCycleTransition>
                    <FromState>ISSUED</FromState>
                    <ToState>REVOKED</ToState>
                    <ConditionForLifeCycleTransition>
                        <EvidenceIsNotValid>true</EvidenceIsNotValid>
                    </ConditionForLifeCycleTransition>
                </lifeCycleTransition>
                <lifeCycleTransition>
                    <FromState>SUSPENDED</FromState>
                    <ToState>REVOKED</ToState>
                    <ConditionForLifeCycleTransition>
                        <EvidenceIsNotValid>true</EvidenceIsNotValid>
                    </ConditionForLifeCycleTransition>
                </lifeCycleTransition>                   
            </LifeCycleTransitions>                   
        </LifeCycleStates>
    </LifeCycle>   
    <Toc Id="ID001">
        <CloudLayer>SaaS</CloudLayer>   
        <ConcreteToc>e-health v1.0</ConcreteToc>   
        <TocDescription>Application</TocDescription>   
        <TocURI>10.0.0.155</TocURI> 
        <ToTs>
            <ToT>
                <Id>0</Id>
                <Target>Target0</Target>
            </ToT>
            <ToT>
                <Id>0</Id>
                <Target>Target1</Target>
            </ToT>
        </ToTs>
        <OperativeCondition>     
            <TocTechnicalSpecifications>
                <TocVendor>ATOS</TocVendor>   
                <TocRelease>1.0</TocRelease> 
                <TocDate>2014-09-24</TocDate>
            </TocTechnicalSpecifications>            
        </OperativeCondition>         
    </Toc>   
    <TestedSecurityProperty SecurityPropertyId="Id101" SecurityPropertyDefinition="This property measures the strength of the mechanism used to authenticate a user, on a scale from 0 to 4, notably taking into account identity proofing, credential security during transfer and storage.">
        <sProperty class="http://cumulus-project.eu/security-properties#IAM:identity-assurance:user-authentication-and-identity-assurance-levelTest">
            <propertyPerformance>
                <propertyPerformanceRow>
                    <propertyPerformanceCell name="level">1</propertyPerformanceCell>
                </propertyPerformanceRow>
            </propertyPerformance>
            <propertyParameterList>
            </propertyParameterList>
        </sProperty>
       
    </TestedSecurityProperty>    
    <Tester>
        
        <TesterName>SesarLab</TesterName>
        <TesterRole>Laboratory</TesterRole>
    </Tester>
   <Context/>
</TestBasedCertificationModel>
